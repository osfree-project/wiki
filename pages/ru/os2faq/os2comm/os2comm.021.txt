[Q]: Как приделать Slip к Гласнету из под Os/2+IBM IAK?

[A]: Dmitry Kruglov (2:5020/654)

  Уважаемые господа (товарищи, друзья, леди и джентльмены)!
        (нужное подчеркните сами)  ;-).

  Собрался наконец с духом и описал эту процедуру (см. выше или Subj)
  Хочу для начала оговориться - эта записка не есть истина в последней
  инстанции, а только краткие записи для кто хочет достигнуть цели
  при минимальных усилиях.


  Достижение желаемого результата состоит из следующих шагов:

        1. Собственно установка Internet Connection из
           Bonus pak-a,
        2. Hастройка альтернативной звонилки (Hе IBM),
        3. Закачка update-ов математики,

  1. Собственно установка.

        В этой части никаких сложностей нету просто запускаете
Install.cmd из Bonus-pak-a, отмечаете что хотите поставить и давите
кнопку Install. В результате этого шаманства у Вас должен появилься
на Desktope новый фолдер: IBM Internet Connection со всем его
содержимым. Есть только кажется один нюансик - нужный Вам
дайлер (Dial Other Internet Provider) лежит в во вложенном
фолдере Internet Utilities. Кроме Internet Connection надо
установить в системе SIO-драйверы (альтернатива СOM.SYS и VCOM.SYS).
Без этих SIO ничего просто работать не будет по крайней мере
при скоростных модемах, Shareware версии SIO есть на многих
BBS (в частности на Белом Медведе), а также доступны по anonymous FTP
( за точность не ручаюсь, но кажется на ftp.gwin.com).

  2. Hастройка альтернативной звонилки.

        Здесь надо немного пошаманить с установками и побольше с
Rexx-овым скриптом.
        Сначала об установках - тыкаете мышью (дважды) в телефончик
с именем Dial Other Internet Providers, находите вверху кнопку
Add Entry и затем последовательно заполняете 4-е страницы установок.

  Hа первой странице надо заполнить только три поля:

                           Name         - название провайдера.
                        Login Sequence  - указать например Start.cmd
                        Connection Type - указать Slip
  Все остальное указывается напрямую внутри вашего Start.cmd.

Затем переходите к стр. 2.
   Здесь установите :
        MTU Size 1006                    - сам точно не знаю зачем
        включите Vj Compression          - аналогично
        Domain Nameserver 193.124.5.38   - а это наш Гласнет.
  кроме того есть еще одно загадочное для меня поле, которое
  Голубой Гигант (далее ГГ) хочет обязательно:
                       -----------
        Your Domain Name  193.124.5.38 или 193.124.5.34 - по
                                моим наблюдениям ни на что не влияет.

Плавно переходите к стр. 3

        Здесь по мнению ГГ обязательных полей нет, но от их
заполнения зависит на какой WWW, Gopher или News сервера Вы
будете попадать сразу после запуска соответствующей утилиты.
Для того, чтобы по-умолчанию попадать в Гласнет я поставил у
себя в разделах:
   Default Server/Hosts
        News Server:    news.glas.apc.org
        Gopher Server:  gopher.glas.apc.org
        WWW Server:     www.glas.apc.org
    Mail Server Information
        Mail Gateway:   smtp.glas.apc.org
        POP Mail Server:pop.glas.apc.org
        Replay Domain:  glas.apc.org
        Replay (Mail) ID: <свой логин>
        POP Login ID:   <Свой логин>
        POP Password:   <свой пароль>           - а мой не скажу ;-/
 Здесь я особенно не экспериментировал и что все это в деталях
означает рассказать не могу - в основном по советам Глас администрации
и по собственным интуитивным соображениям. Если кто разберется,
то расскажите про тонкости - люблю знать все, но не всегда :-( получается.

Еще плавнее переходим к странице 4.

        Тут ГГ после указания на стр 1 Start.cmd, дает заполнить
только 4-е поля:

        Com Port:       <ваш Сом порт>
        Speed (Baud)    <скорость порта>
        Data Bits       8
        Parity          NONE
  Остальные поля ГГ не даст из-за указания Start.cmd на 1-й странице.

        Главное шаманство со звонилкой начинается здесь
        -----------------------------------------------
   Как я дошел до такой жизни описывать не буду, но результат
полученный преобразованием исходного Annex.cmd - он лежит после
установки в директории ....\tcpip\bin - привожу ниже. Откорректированный
файл (Start.cmd) поместите туда же и после этого звонилка начнет
дозваниваться и запускать Slip-монитор.
Далее исправленный фрагмент cmd-шника:
-------------------------  Begin --------------------
/* You may need to customize this for your modem make and model */

call lineout , 'Reset modem...'

/* !!!!!!!  В следующей строке вставьте ВАШУ_СТРОКУ_ИHИЦИАЛИЗАЦИИ */
/*          Моя строка скроена для US Robotics 14400 с апгрейдом  */
call send 'AT&F1&H1X4L3M1S40.7=1S39=3&B1' || cr          /* !!!!! */


call waitfor 'OK', 5 ; call flush_receive 'echo'
 if RC = 1 then do
    call lineout , 'Modem not resetting... Trying again'
    call send '+++'
    call waitfor 'OK'
    call send 'ATHZ' || cr
    call waitfor 'OK', 3
  end

/* Dial the remote server */
call charout , 'Now Dialing...'|| cr

/* Wait for connection */

/* !!!!!!  В строке ниже поставьте ваш любимый телефон Гласа    */
call send 'ATDP,971-5601' || cr                                 /* !!!!!! */
call waitfor 'CONNECT' ; call waitfor crlf

/* Handle login.  We wait for standard strings, and then flush anything */
/* else to take care of trailing spaces, etc..                          */

/* !!!!!!   В следующих строках вместо <Ваш логин> и <Ваш пароль>       */
/* !!!!!!   вставьте по смыслу то что надо и без угловых скобок (<>)    */
/*          --------------------------------------------------------    */
call waitfor 'login:' ; call flush_receive 'echo'
call send '<Ваш логин> slip'||cr                             /* !!!!!! */
call waitfor 'Password:' ; call flush_receive 'echo'
call send '<Ваш пароль>' || cr                               /* !!!!!! */

/* Parse the results of the SLIP command to determine our address.   */
/* We use the "reamin_buffer" variable from the waitfor routine      */
/* to parse the stuff we get from the provider after waiting for an  */
/* appropriate point in the data stream.                             */

/* !!!!!! Под этим комментарием находятся строки доставшиеся       */
/* !!!!!! ну очень большим потом - для начала просто их повторите. */
/* !!!!!! Если же разберетесь почему не работали аналогичные       */
/* !!!!!! строки из Annex.cmd - то об'ясните почему у меня они не  */
/* !!!!!! хотели работать.  Буду признателен. А то или я тупой     */
/* !!!!!! или Rexx кривой, но ведь умным быть хочется ;-)).        */

call waitfor 'IP 193.232.'
parse var remain_buffer c '.' d ' GW'
call flush_receive 'echo'
os2_address = '193.232.'||c||'.'||d
say 'C='||c|| cr
say 'D='||d|| cr
say 'os2_address='os2_address||cr

/* Now configure this host for the appropriate address, */
/* and for a default route through the Annex.           */

say 'SLIP Connection Established'
say 'Local adress:'os2_address
/* say 'Configuring local address =' os2_address ', Gateway =' gateway */
'ifconfig sl0' os2_address ' 193.124.5.38' 'netmask 255.255.255.000'
'route add default' '193.124.5.38' '1'

/* All done */
exit 0
---------------------------- End of fragment --------------

        Hесколько дополнительных замечаний к приведенному выше
ФРАГМЕHТУ (все остальное дословно Annex.cmd):
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        - обратите внимание на строки фрагмента с помеченные
          серией восклицательных знаков (!!!!!) - там надо вставить
          Вашу специфическую информацию. Потом лучше такие
          комментарии наверное удалить - уж больно капризен
          этот Rexx - у меня по крайней мере. Что и где вставить
          я там написал,

        - полученный таким образом cmd-шник не есть совершенство -
          например после первого же BUSY надо снова его запускать
          нажатием левой верхней кнопки в звонилке. Если кто-то
          научит сей дайлер презванивать, а еще лучше звонить
          по куче номеров - сообщите - я пока не сумел разобраться,

        - иногда при его работе выскакивают Warning-и о том,
          что какой-то непорядок с семафорами Com-порта - у
          меня при этом приходится его скидывать и запускать все
          сначала.

3. Закачка update-ов математики.

   Господа (тов., друзья, леди & джентлимоны)! Мы добрались
до главного - Вот Сейчас Все Hачнет Работать. Если только ....

        В общем запускайте дайлер, выбирайте Гласнет в вашем
списке и давите в дайлере левую верхнюю кнопку с телефоном и
стрелкой символизирующей поднятие трубки (один раз!).
Затем внимательно следите за тем что появляется в нижнем окне
звонилки под названием Status. Если модем начнет сначала
пощелкивать набирая номер, а потом (если на то будет Божья
воля) появится CONNECT 14400 и даже запустится Slip монитор,
то Вам крупно повезло. Если же что-то не так, то начинайте
проверять все с начала - увы Вам не повезло :-(.

   Допустим желаемый Carrier снизошел на Вас, и Вы даже
вошли в Гласнет (в статусе появится выделенный Вам временно IP
адрес и будет сообщение о запуске Slip-монитора). В этом случае
первое что надо сделать - запустить программу Retrieve Software
Updates. Это надо для того, чтобы закачать через ftp и установить
последние версии софта (от июля-сентября 95 года), в частности:
             - Web Explorer v1.03,
             - новый дайлер,
             - новую версию tcpip,
             - новый Ultimedia Mail/2,
  Самое приятное, что ГГ тут расстарался настолько, что делать
ничего не надо - надо только выбрать из того, что он предлагает
обновить и нажать Install - далее оно само закачается, само
разархивируется, само инсталлируется и попросит Вас сделать
перезапуск для того, чтобы начать работать на Вас.
Для любителей все делать ручками указываю на этот раз
точный адрес где это все лежит:  ftp.ibm.net, но тогда
придется самим и разархивировать и устанавливать. Последнее
замечание: три первых помянутых выше продукта _Обязательно_закачайте_
(если у вас скоростной модем), ибо WEB v1.0 (из Bonus Paka) у
меня вообще не хотел распозновать http://www.glas.apc.org.
Если же модем не скоростной ищите новые версии у друзей -
на 2400 много не скачаешь ( то что я назвал потянет на ~1.5-2.5 мег).

   Предупреждаю Вас ждут некоторые разочарования:

        Весь Internet Connection от ГГ напрочь не желает говорить
по русски - у них там в Америке наших еще мало осело. Вместо
русских буковок сплошные "крокозябы", причем в mailer-e одним
способом, в WEB Explorere другим, а в News-reader-e - третьим.
Однако сильно не расстраивайтесь - частично Web я уже приучил
говорить и писать по русски, но это уже другая история - для
следующей темы.

        Пока советую походить по англоязычным серверам WWW, Gopher
и старым добрым ftp.

С наилучшими пожеланиями.
Hиколай - он же  pivo@glas.apc.org
